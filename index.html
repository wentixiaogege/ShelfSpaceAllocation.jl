<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Model · ShelfSpaceAllocation</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link href="assets/documenter.css" rel="stylesheet" type="text/css"/><link href="assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><nav class="toc"><a href><img class="logo" src="assets/logo.svg" alt="ShelfSpaceAllocation logo"/></a><h1>ShelfSpaceAllocation</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li class="current"><a class="toctext" href>Model</a><ul class="internal"><li><a class="toctext" href="#Sets-and-Subsets-1">Sets and Subsets</a></li><li><a class="toctext" href="#Parameters-1">Parameters</a></li><li><a class="toctext" href="#Objective-1">Objective</a></li><li><a class="toctext" href="#Basic-Variables-and-Constraints-1">Basic Variables and Constraints</a></li><li><a class="toctext" href="#Block-Variables-and-Constraints-1">Block Variables and Constraints</a></li><li><a class="toctext" href="#References-1">References</a></li></ul></li><li><a class="toctext" href="plotting/">Plotting</a></li><li><a class="toctext" href="heuristics/">Heuristics</a></li><li><a class="toctext" href="api/">API</a></li></ul></nav><article id="docs"><header><nav><ul><li><a href>Model</a></li></ul><a class="edit-page" href="https://github.com/jaantollander/ShelfSpaceAllocation/blob/master/docs/src/index.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>Model</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="ShelfSpaceAllocation.jl-1" href="#ShelfSpaceAllocation.jl-1">ShelfSpaceAllocation.jl</a></h1><p><img src="figures/results/planogram.svg" alt/></p><p>This section explains the mathematical formulation of the <em>mixed integer linear program</em> for solving the <em>shelf space allocation problem</em>. Ph.D. thesis by <a href="#footnote-Teresa2015">[Teresa2015]</a> contains a good introduction to the shelf space allocation problem. We recommend to read the chapters 1.3 and 3 as they relate to the model we present here. Book by <a href="#footnote-Williams2013">[Williams2013]</a> covers how to model problems using mathematical programming including linear and integer programming.</p><p>The objective of <a href="api/#ShelfSpaceAllocation.ShelfSpaceAllocationModel"><code>ShelfSpaceAllocationModel</code></a> presented here is to minimize losses while taking into account consumer demand for products, minimize empty space on shelves and place products at preferred heights. The model is tailored towards smaller retail stores for which the shelf space accounts for a large portion of the total inventory space.</p><p>The model also contains different types of constraints:</p><ul><li><em>Integrality constraints</em> – The number of products allocated to each shelf must be integral.</li><li><em>Physical constraints</em> – Constraints limiting the physical dimensions, e.g. width, height, and weight, of the products on the shelves.</li><li><em>Control constraints</em> – Constraints which can be controlled by changing parameters values, such as the minimum number of product facings for a particular product or the preferred height placement for a product.</li><li><em>Block constraints</em> – Constraints products which belong to the same category to be placed together in rectangular shapes.</li></ul><p>We can create an instance of the model using <a href="api/#ShelfSpaceAllocation.ShelfSpaceAllocationModel-Tuple{Params,Specs}"><code>ShelfSpaceAllocationModel(::Params, ::Specs)</code></a>.</p><p>The output values from the optimization are used to produce a <a href="plotting/#Planogram-1">Planogram</a>, which is a visualization of the product placement on to the shelves.</p><h2><a class="nav-anchor" id="Sets-and-Subsets-1" href="#Sets-and-Subsets-1">Sets and Subsets</a></h2><p>Shelf space allocation problem consists of following sets and subsets:</p><ul><li><span>$p∈P$</span> – A set of <strong>products</strong>.</li><li><span>$s∈S$</span> – A set of <strong>shelves</strong>.</li><li><span>$b∈B$</span> – A set of <strong>blocks</strong>. Blocks are an index of mutually exclusive subsets of products.</li><li><span>$m∈M$</span> – A set of <strong>modules</strong>. Modules are an index of a mutually exclusive subset of shelves.</li><li><span>$P_b⊆P$</span> – A <strong>block</strong> is a subset of products.</li><li><span>$S_m⊆S$</span> – A <strong>module</strong> is a subset of shelves.</li></ul><h2><a class="nav-anchor" id="Parameters-1" href="#Parameters-1">Parameters</a></h2><p>Both products and shelves have several attributes associated with them. These attributes are also referred to as parameters since their values are given by the user. They are denoted using capital letters.</p><p>Products</p><ul><li><span>$N_p^{min}$</span>, <span>$N_p^{max}$</span> – The minimum and maximum number of facings for product <span>$p$</span></li><li><span>$G_p$</span> – Unit profit of product <span>$p$</span>; used as shortage penalty (treated to be <span>$\max\{0, G_p\}$</span></li><li><span>$R_p$</span> – Replenishment period of product <span>$p$</span></li><li><span>$D_p$</span> – Demand forecast of product <span>$p$</span></li><li><span>$L_p$</span> – Priority weight for height placement of product <span>$p$</span></li><li><span>$W_p$</span> – Facing width of product <span>$p$</span></li><li><span>$H_p$</span> – Height of product <span>$p$</span></li><li><span>$M_p$</span> – Unit weight of product <span>$p$</span></li><li><span>$SK_p$</span> – Max stack per product <span>$p$</span></li></ul><p>Shelves</p><ul><li><span>$M_s^{min}$</span>, <span>$M_s^{max}$</span> – The minimum and maximum unit weight on shelf <span>$s$</span></li><li><span>$W_s$</span> – Width of shelf <span>$s$</span></li><li><span>$H_s$</span> – Height of shelf <span>$s$</span></li><li><span>$L_s$</span> – Shelf level, counted from bottom to top</li></ul><p>Product-shelves</p><ul><li><span>$P_{p,s}$</span> – Number units per facing of product <span>$p$</span> on shelf <span>$s$</span></li></ul><p>Constants</p><ul><li><span>$SL$</span> – Slack, maximum difference in block starting points and between block max and min width, default <span>$0.0$</span></li><li><span>$w_1$</span> – Objective weight for <code>empty_space_penalty</code>, default <span>$0.5$</span></li><li><span>$w_2$</span> – Objective weight for <code>shortage_penalty</code>, default <span>$10.0$</span></li><li><span>$w_3$</span> – Objective weight for <code>shelf_up_down_penalty</code>, default <span>$0.1$</span></li></ul><p>Currently, the objective weights are set to empirically tested values.</p><p>To pass parameters as arguments we use the <a href="api/#ShelfSpaceAllocation.Params"><code>Params</code></a> struct. We can load parameters from CSV files using <a href="api/#ShelfSpaceAllocation.Params-Tuple{AbstractString,AbstractString}"><code>Params(::AbstractString, ::AbstractString)</code></a>.</p><h2><a class="nav-anchor" id="Objective-1" href="#Objective-1">Objective</a></h2><div class="admonition note"><div class="admonition-title">Note</div><div class="admonition-text"><p>Currently, JuMP doesn&#39;t support multi-objective optimization, and thus the weights are manually tuned such that the algorithm obtains satisfying solutions. However, solvers such as Gurobi have capabilities for multi-objective optimization and using them should be considered in the future.</p></div></div><p>The shelf space allocation model contains multiple objectives. The multi-objective formulation is reduced into single objective using linear scalarization, i.e. weighted sum</p><div>\[\min ∑_{i=1}^n w_i f_i\]</div><p>where <span>$f_i$</span> are the objectives and <span>$w_i&gt;0$</span> are the weight parameters. We have <span>$n=3$</span> different individual objectives as follows.</p><p>The total empty shelf space.</p><div>\[f_1=∑_s o_s\]</div><p>Total profit loss from product shortage.</p><div>\[f_2=∑_p G_p e_p\]</div><p>Product shelf height placement penalty. Preferres the placement of products with higher weight <span>$L_p$</span> to lower shelves.</p><div>\[f_3=∑_{p,s} L_p L_s n_{p,s}\]</div><p>We use <a href="api/#ShelfSpaceAllocation.Objectives"><code>Objectives</code></a> struct to store the objetive values after optimization. We can query the values from the model using <a href="api/#ShelfSpaceAllocation.Objectives-Tuple{JuMP.Model}"><code>Objectives(::ShelfSpaceAllocationModel)</code></a> method.</p><h2><a class="nav-anchor" id="Basic-Variables-and-Constraints-1" href="#Basic-Variables-and-Constraints-1">Basic Variables and Constraints</a></h2><p><img src="figures/planogram_no_blocks.svg" alt/></p><p>Number of facings of product <span>$p$</span> on shelf <span>$s$</span></p><div>\[n_{p,s} ∈ ℤ_{≥0},\quad ∀p,s\]</div><p>The height of product <span>$p$</span> allocated on shelf <span>$s$</span> must be less or equal to the shelf height</p><div>\[n_{p,s}=0,\quad ∀p,s∣H_p &gt; H_s\]</div><p>The unit weight of product <span>$p$</span> allocated on shelf <span>$s$</span> must be less or equal to the maximum unit weight allowed on the shelf</p><div>\[n_{p,s}=0,\quad ∀p,s∣M_p &gt; M_s^{max}\]</div><p>A decision variable which takes value <span>$1$</span>, if a product is allocated to a shelf, <span>$0$</span> otherwise</p><div>\[y_p ∈ \{0,1\},\quad ∀p\]</div><div>\[∑_p n_{p,s} ≥ y_{p},\quad ∀p\]</div><p>The total number of facings of product <span>$p$</span> must be within the given minimum and maximum</p><div>\[N_p^{min} y_p ≤ ∑_s n_{p,s} ≤ N_p^{max} y_p,\quad ∀p\]</div><p>The amount of product <span>$p$</span> sold must be less or equal to the minimum of the expected sales and demand</p><div>\[s_p ≥ 0,\quad ∀p\]</div><div>\[s_p ≤ \min\left(∑_s \frac{30}{R_p} P_{p,s} n_{p,s}, D_p\right),\quad ∀p\]</div><div class="admonition note"><div class="admonition-title">Note</div><div class="admonition-text"><p>The constraint of the form <span>$z≤\min(x,y)$</span> can be linearized by replacing it with two constraints <span>$z≤x$</span> and <span>$z≤y$</span>.</p></div></div><p>The shortage of product <span>$p$</span> is the mismatch between demand and on-shelf inventory</p><div>\[e_p ≥ 0,\quad ∀p\]</div><div>\[s_p + e_p = D_p,\quad ∀p\]</div><p>Total empty space on shelf <span>$s$</span> is the difference between the width of the shelf <span>$s$</span> and the total width of the products on shelf <span>$s$</span></p><div>\[o_s ≥ 0,\quad ∀s\]</div><div>\[∑_p W_p n_{p,s} + o_s = W_s,\quad ∀s\]</div><p>We use <a href="api/#ShelfSpaceAllocation.Variables"><code>Variables</code></a> struct to store the variable values after optimization. We can query the values from the model using <a href="api/#ShelfSpaceAllocation.Variables-Tuple{JuMP.Model}"><code>Variables(::ShelfSpaceAllocationModel)</code></a> method.</p><h2><a class="nav-anchor" id="Block-Variables-and-Constraints-1" href="#Block-Variables-and-Constraints-1">Block Variables and Constraints</a></h2><p><img src="figures/results/planogram.svg" alt/></p><p>We use the <a href="api/#ShelfSpaceAllocation.Specs"><code>Specs</code></a> struct to control whether we include block constraints into the model.</p><p>The width of block <span>$b$</span> on shelf <span>$s$</span> must be larger or equal to the sum of the widths of products <span>$P_b$</span> on the shelf <span>$s$</span></p><div>\[b_{b,s}≥0,\quad ∀b,s\]</div><div>\[∑_{p∈P_b} W_p n_{p,s} ≤ b_{b,s},\quad ∀b,s\]</div><p>The sum of the block widths on each shelf <span>$s$</span> must be less or equal to the width of the shelf <span>$s$</span></p><div>\[∑_b b_{b,s} ≤ W_s,\quad ∀s\]</div><p>An indicator variable which takes value <span>$1$</span> if block is assigned on a shelf <span>$s$</span>, <span>$0$</span> otherwise</p><div>\[z_{b,s}∈\{0,1\},\quad ∀b,s\]</div><div>\[b_{b,s} ≤ W_s z_{b,s},\quad ∀b,s\]</div><div class="admonition note"><div class="admonition-title">Note</div><div class="admonition-text"><p>Indicator variable <span>$σ$</span> is a binary variable which is forced to take value <span>$1$</span> when <span>$x&gt;0$</span>, otherwise <span>$0$</span>, by the constraint <span>$x≤Mσ$</span> where <span>$M$</span> is a constant coefficient representing a known upper bound for <span>$x$</span>.</p></div></div><p>Block width on module <span>$m$</span></p><div>\[m_{b,m}≥0,\quad ∀b,m\]</div><div>\[b_{b,s} ≥ m_{b,m} - W_s (1 - z_{b,s}) - SL,\quad ∀b,m,s∣s∈S_m\]</div><div>\[b_{b,s} ≤ m_{b,m} + W_s (1 - z_{b,s}) + SL,\quad ∀b,m,s∣s∈S_m\]</div><hr/><p>A decision variable which takes value <span>$1$</span> if shelf <span>$s$</span> is the first shelf of a block <span>$b$</span>, <span>$0$</span> otherwise</p><div>\[z_{b,s}^f∈\{0,1\},\quad ∀b,s\]</div><p>A decision variable which takes value <span>$1$</span> if shelf <span>$s$</span> is the last shelf of a block <span>$b$</span>, <span>$0$</span> otherwise</p><div>\[z_{b,s}^l∈\{0,1\},\quad ∀b,s\]</div><p>Each block <span>$b$</span> has only one first shelf</p><div>\[∑_s z_{b,s}^f ≤ 1,\quad ∀b\]</div><p>Each block <span>$b$</span> has only one last shelf</p><div>\[∑_s z_{b,s}^l ≤ 1,\quad ∀b\]</div><p>Block assignment <span>$z_{b,s}$</span> of block <span>$b$</span> is continuous from the first shelf to the last shelf of the block</p><div>\[z_{b,s}^f = z_{b,s},\quad ∀b,s=1\]</div><div>\[z_{b,s}^l = z_{b,s},\quad ∀b,s=|S|\]</div><div>\[z_{b,s+1}^f + z_{b,s} = z_{b,s+1} + z_{b,s}^l,\quad ∀b,s∣s≤|S|-1\]</div><hr/><p>If block <span>$b$</span> is assigned on shelf <span>$s$</span> then the total number of facings assigned to shelf <span>$s$</span> must be at least one</p><div>\[∑_{p∈P_b} n_{p,s} ≥ z_{b,s},\quad ∀b,s\]</div><p>If block <span>$b$</span> is not assignment on shelf <span>$s$</span> then the number of facings of products in <span>$P_b$</span> on shelf <span>$s$</span> must be zero.</p><div>\[n_{p,s} ≤ N_p^{max} z_{b,s},\quad ∀b,p,s∣p∈P_b\]</div><hr/><p>Block starting location (in mm) on shelf <span>$s$</span></p><div>\[x_{b,s}≥0,\quad ∀b,s\]</div><p>Block starting location is zero if block <span>$b$</span> is not assigned on shelf <span>$s$</span></p><div>\[x_{b,s} ≤ W_s z_{b,s},\quad ∀b,s\]</div><p>Block ending location must not exceed the shelf width</p><div>\[x_{b,s} + b_{b,s} ≤ W_s,\quad ∀b,s\]</div><p>A decision variable which takes value <span>$1$</span> if block <span>$b$</span> precedes block <span>$b&#39;$</span>, <span>$0$</span> otherwise. Notice that <span>$b$</span> and <span>$b&#39;$</span> are mutually exclusive, i.e. <span>$b≠b&#39;$</span></p><div>\[w_{b,b&#39;}∈\{0,1\},\quad ∀b,b&#39;\]</div><div>\[x_{b,s} + W_s (1 - z_{b,s}) ≥ x_{b&#39;,s} + b_{b,s} - W_s (1 - w_{b,b&#39;}),\quad ∀b,b&#39;,m∣b≠b&#39;\]</div><div>\[x_{b&#39;,s} + W_s (1 - z_{b&#39;, s}) ≥ x_{b,s} + b_{b,s} - W_s w_{b,b&#39;},\quad ∀b,b&#39;,m∣b≠b&#39;\]</div><p>Block starting location on module <span>$m$</span></p><div>\[x_{b,m}≥0,\quad ∀b,m\]</div><div>\[x_{b,m} ≥ x_{b,s} - W_s (1 - z_{b,s}) - SL,\quad ∀b,m,s∣s∈S_m\]</div><div>\[x_{b,m} ≤ x_{b,s} + W_s (1 - z_{b,s}) + SL,\quad ∀b,m,s∣s∈S_m\]</div><hr/><p>An indicator variable which takes value <span>$1$</span> if a block is assigned on a module, <span>$0$</span> otherwise</p><div>\[v_{b,m}∈\{0,1\},\quad ∀b,m\]</div><p>If a block is not assigned module there must be zero facings of the product belonging to the block on the shelves belonging to the module</p><div>\[n_{p,s} ≤ N_p^{max} v_{b,m},\quad ∀p,b,m,s∣s∈S_m,p∈P_b\]</div><p>Block <span>$b$</span> is assigned to only one module <span>$m$</span></p><div>\[∑_m v_{b,m} ≤ 1,\quad ∀b\]</div><h2><a class="nav-anchor" id="References-1" href="#References-1">References</a></h2><div class="footnote" id="footnote-Teresa2015"><a href="#footnote-Teresa2015"><strong>[Teresa2015]</strong></a><p>Teresa, M. (2015). The Retail Shelf Space Allocation Problem: New Optimization Methods Applied to a Supermarket Chain.</p></div><div class="footnote" id="footnote-Williams2013"><a href="#footnote-Williams2013"><strong>[Williams2013]</strong></a><p>Williams, H. P. (2013). Model building in mathematical programming. John Wiley &amp; Sons.</p></div><footer><hr/><a class="next" href="plotting/"><span class="direction">Next</span><span class="title">Plotting</span></a></footer></article></body></html>
